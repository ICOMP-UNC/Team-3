<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CONVEYOR_BELT: include/setpoint.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CONVEYOR_BELT<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)"
               onblur="searchBox.OnSearchFieldFocus(false)"
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('setpoint_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">setpoint.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Potentiometer module for ADC with DMA on STM32.
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;libopencm3/stm32/adc.h&gt;</code><br />
<code>#include &lt;libopencm3/stm32/dma.h&gt;</code><br />
<code>#include &lt;libopencm3/stm32/gpio.h&gt;</code><br />
<code>#include &lt;libopencm3/stm32/rcc.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for setpoint.h:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h__incl.png" border="0" usemap="#ainclude_2setpoint_8h" alt=""/></div>
<map name="ainclude_2setpoint_8h" id="ainclude_2setpoint_8h">
<area shape="rect" title="Potentiometer module for ADC with DMA on STM32." alt="" coords="309,5,433,32"/>
<area shape="rect" title=" " alt="" coords="5,80,169,107"/>
<area shape="poly" title=" " alt="" coords="322,35,152,78,151,73,321,30"/>
<area shape="rect" title=" " alt="" coords="193,80,360,107"/>
<area shape="poly" title=" " alt="" coords="356,35,306,73,303,68,353,30"/>
<area shape="rect" title=" " alt="" coords="384,80,550,107"/>
<area shape="poly" title=" " alt="" coords="389,30,440,68,437,73,386,35"/>
<area shape="rect" title=" " alt="" coords="575,80,735,107"/>
<area shape="poly" title=" " alt="" coords="421,30,591,73,590,78,420,35"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h__dep__incl.png" border="0" usemap="#ainclude_2setpoint_8hdep" alt=""/></div>
<map name="ainclude_2setpoint_8hdep" id="ainclude_2setpoint_8hdep">
<area shape="rect" title="Potentiometer module for ADC with DMA on STM32." alt="" coords="5,5,129,32"/>
<area shape="rect" href="setpoint_8c_source.html" title=" " alt="" coords="17,80,117,107"/>
<area shape="poly" title=" " alt="" coords="70,48,70,80,64,80,64,48"/>
</map>
</div>
</div>
<p><a href="setpoint_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a9d38dfadc4abfb7ab99132637e312f98" id="r_a9d38dfadc4abfb7ab99132637e312f98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9d38dfadc4abfb7ab99132637e312f98">N_DATA</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:a9d38dfadc4abfb7ab99132637e312f98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of data samples to collect via DMA.  <br /></td></tr>
<tr class="separator:a9d38dfadc4abfb7ab99132637e312f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f6cb73076ef21c6d4a8b7b695ca285" id="r_a40f6cb73076ef21c6d4a8b7b695ca285"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40f6cb73076ef21c6d4a8b7b695ca285">CONSTANT_TO_PERCENTAGE</a>&#160;&#160;&#160;(24.42e-3) / <a class="el" href="#a9d38dfadc4abfb7ab99132637e312f98">N_DATA</a></td></tr>
<tr class="memdesc:a40f6cb73076ef21c6d4a8b7b695ca285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conversion constant to calculate potentiometer percentage value.  <br /></td></tr>
<tr class="separator:a40f6cb73076ef21c6d4a8b7b695ca285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b445b81ba3afc303b51c2c285bfbf98" id="r_a8b445b81ba3afc303b51c2c285bfbf98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8b445b81ba3afc303b51c2c285bfbf98">SAMPLE_TIME_CYCLES</a>&#160;&#160;&#160;ADC_SMPR_SMP_239DOT5CYC</td></tr>
<tr class="memdesc:a8b445b81ba3afc303b51c2c285bfbf98"><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC sample time configuration.  <br /></td></tr>
<tr class="separator:a8b445b81ba3afc303b51c2c285bfbf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cd2c638c2d03f35a615a209652b60ce" id="r_a5cd2c638c2d03f35a615a209652b60ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5cd2c638c2d03f35a615a209652b60ce">POT_ADC</a>&#160;&#160;&#160;ADC1</td></tr>
<tr class="memdesc:a5cd2c638c2d03f35a615a209652b60ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC used for potentiometer readings.  <br /></td></tr>
<tr class="separator:a5cd2c638c2d03f35a615a209652b60ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6128d163dc8a51921a873cb88d103399" id="r_a6128d163dc8a51921a873cb88d103399"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6128d163dc8a51921a873cb88d103399">POT_ADC_CHANNEL</a>&#160;&#160;&#160;ADC_CHANNEL9</td></tr>
<tr class="memdesc:a6128d163dc8a51921a873cb88d103399"><td class="mdescLeft">&#160;</td><td class="mdescRight">ADC channel associated with the potentiometer input.  <br /></td></tr>
<tr class="separator:a6128d163dc8a51921a873cb88d103399"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1385f4e525b4136940aac22fad3ca50" id="r_ae1385f4e525b4136940aac22fad3ca50"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1385f4e525b4136940aac22fad3ca50">POT_DMA_CHANNEL</a>&#160;&#160;&#160;DMA_CHANNEL1</td></tr>
<tr class="memdesc:ae1385f4e525b4136940aac22fad3ca50"><td class="mdescLeft">&#160;</td><td class="mdescRight">DMA channel associated with the ADC.  <br /></td></tr>
<tr class="separator:ae1385f4e525b4136940aac22fad3ca50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7dc0396af4046bed34abda65d4386b0" id="r_ad7dc0396af4046bed34abda65d4386b0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7dc0396af4046bed34abda65d4386b0">POT_PORT</a>&#160;&#160;&#160;GPIOB</td></tr>
<tr class="memdesc:ad7dc0396af4046bed34abda65d4386b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO port where the potentiometer pin is connected.  <br /></td></tr>
<tr class="separator:ad7dc0396af4046bed34abda65d4386b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae89f73e4cdcb650ae5c585818d3a861" id="r_aae89f73e4cdcb650ae5c585818d3a861"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae89f73e4cdcb650ae5c585818d3a861">POT_PIN</a>&#160;&#160;&#160;GPIO1</td></tr>
<tr class="memdesc:aae89f73e4cdcb650ae5c585818d3a861"><td class="mdescLeft">&#160;</td><td class="mdescRight">GPIO pin where the potentiometer is connected.  <br /></td></tr>
<tr class="separator:aae89f73e4cdcb650ae5c585818d3a861"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afc9477c3f1fe70660be0e366c146cb2a" id="r_afc9477c3f1fe70660be0e366c146cb2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc9477c3f1fe70660be0e366c146cb2a">pot_init</a> (void)</td></tr>
<tr class="memdesc:afc9477c3f1fe70660be0e366c146cb2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the ADC and DMA for potentiometer readings.  <br /></td></tr>
<tr class="separator:afc9477c3f1fe70660be0e366c146cb2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a5d4b137f31855b38eb58dc5c2dd3a2" id="r_a8a5d4b137f31855b38eb58dc5c2dd3a2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a5d4b137f31855b38eb58dc5c2dd3a2">pot_get_value</a> (void)</td></tr>
<tr class="memdesc:a8a5d4b137f31855b38eb58dc5c2dd3a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the latest potentiometer value.  <br /></td></tr>
<tr class="separator:a8a5d4b137f31855b38eb58dc5c2dd3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Potentiometer module for ADC with DMA on STM32. </p>
<p>This module initializes an ADC to read values from a potentiometer using DMA. It includes functions to initialize the potentiometer ADC and retrieve the ADC value. </p>

<p class="definition">Definition in file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a40f6cb73076ef21c6d4a8b7b695ca285" name="a40f6cb73076ef21c6d4a8b7b695ca285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40f6cb73076ef21c6d4a8b7b695ca285">&#9670;&#160;</a></span>CONSTANT_TO_PERCENTAGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONSTANT_TO_PERCENTAGE&#160;&#160;&#160;(24.42e-3) / <a class="el" href="#a9d38dfadc4abfb7ab99132637e312f98">N_DATA</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Conversion constant to calculate potentiometer percentage value. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00018">18</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00062">pot_get_value()</a>.</p>

</div>
</div>
<a id="a9d38dfadc4abfb7ab99132637e312f98" name="a9d38dfadc4abfb7ab99132637e312f98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d38dfadc4abfb7ab99132637e312f98">&#9670;&#160;</a></span>N_DATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_DATA&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of data samples to collect via DMA. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00015">15</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00062">pot_get_value()</a>, and <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<a id="a5cd2c638c2d03f35a615a209652b60ce" name="a5cd2c638c2d03f35a615a209652b60ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cd2c638c2d03f35a615a209652b60ce">&#9670;&#160;</a></span>POT_ADC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POT_ADC&#160;&#160;&#160;ADC1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ADC used for potentiometer readings. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00024">24</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

</div>
</div>
<a id="a6128d163dc8a51921a873cb88d103399" name="a6128d163dc8a51921a873cb88d103399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6128d163dc8a51921a873cb88d103399">&#9670;&#160;</a></span>POT_ADC_CHANNEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POT_ADC_CHANNEL&#160;&#160;&#160;ADC_CHANNEL9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ADC channel associated with the potentiometer input. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00027">27</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<a id="ae1385f4e525b4136940aac22fad3ca50" name="ae1385f4e525b4136940aac22fad3ca50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1385f4e525b4136940aac22fad3ca50">&#9670;&#160;</a></span>POT_DMA_CHANNEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POT_DMA_CHANNEL&#160;&#160;&#160;DMA_CHANNEL1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DMA channel associated with the ADC. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00030">30</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<a id="aae89f73e4cdcb650ae5c585818d3a861" name="aae89f73e4cdcb650ae5c585818d3a861"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae89f73e4cdcb650ae5c585818d3a861">&#9670;&#160;</a></span>POT_PIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POT_PIN&#160;&#160;&#160;GPIO1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPIO pin where the potentiometer is connected. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00036">36</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<a id="ad7dc0396af4046bed34abda65d4386b0" name="ad7dc0396af4046bed34abda65d4386b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7dc0396af4046bed34abda65d4386b0">&#9670;&#160;</a></span>POT_PORT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define POT_PORT&#160;&#160;&#160;GPIOB</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPIO port where the potentiometer pin is connected. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00033">33</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<a id="a8b445b81ba3afc303b51c2c285bfbf98" name="a8b445b81ba3afc303b51c2c285bfbf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b445b81ba3afc303b51c2c285bfbf98">&#9670;&#160;</a></span>SAMPLE_TIME_CYCLES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SAMPLE_TIME_CYCLES&#160;&#160;&#160;ADC_SMPR_SMP_239DOT5CYC</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ADC sample time configuration. </p>

<p class="definition">Definition at line <a class="el" href="setpoint_8h_source.html#l00021">21</a> of file <a class="el" href="setpoint_8h_source.html">setpoint.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8a5d4b137f31855b38eb58dc5c2dd3a2" name="a8a5d4b137f31855b38eb58dc5c2dd3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a5d4b137f31855b38eb58dc5c2dd3a2">&#9670;&#160;</a></span>pot_get_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float pot_get_value </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the latest potentiometer value. </p>
<p>This function returns the current potentiometer reading as an ADC value. It should be called after <code>pot_init</code> has configured the ADC and DMA.</p>
<dl class="section return"><dt>Returns</dt><dd>The ADC value corresponding to the potentiometer position (0-4095 for 12-bit resolution).</dd></dl>
<p>Get the potentiometer value by averaging the ADC buffer values </p>
<p>Accumulator for averaging buffer values</p>
<p>Sum up all values in the buffer</p>
<p>Return the average value, converted to a percentage</p>

<p class="definition">Definition at line <a class="el" href="setpoint_8c_source.html#l00062">62</a> of file <a class="el" href="setpoint_8c_source.html">setpoint.c</a>.</p>

<p class="reference">References <a class="el" href="setpoint_8h_source.html#l00018">CONSTANT_TO_PERCENTAGE</a>, <a class="el" href="setpoint_8h_source.html#l00015">N_DATA</a>, and <a class="el" href="setpoint_8c_source.html#l00062">pot_get_value()</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00062">pot_get_value()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_cgraph.png" border="0" usemap="#asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_cgraph" alt=""/></div>
<map name="asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_cgraph" id="asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_cgraph">
<area shape="rect" title="Retrieves the latest potentiometer value." alt="" coords="5,29,108,56"/>
<area shape="poly" title=" " alt="" coords="38,30,35,20,37,11,44,5,57,3,69,5,76,12,73,16,67,10,56,8,47,10,41,14,40,20,43,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_icgraph.png" border="0" usemap="#asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_icgraph" alt=""/></div>
<map name="asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_icgraph" id="asetpoint_8h_a8a5d4b137f31855b38eb58dc5c2dd3a2_icgraph">
<area shape="rect" title="Retrieves the latest potentiometer value." alt="" coords="5,29,108,56"/>
<area shape="poly" title=" " alt="" coords="73,16,67,10,56,8,47,10,41,14,40,20,43,28,38,30,35,20,37,11,44,5,57,3,69,5,76,12"/>
</map>
</div>

</div>
</div>
<a id="afc9477c3f1fe70660be0e366c146cb2a" name="afc9477c3f1fe70660be0e366c146cb2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc9477c3f1fe70660be0e366c146cb2a">&#9670;&#160;</a></span>pot_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pot_init </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the ADC and DMA for potentiometer readings. </p>
<p>This function configures the ADC and DMA to sample potentiometer values from the specified channel. It sets up GPIO, enables the required clocks, configures the ADC sample time, and initiates DMA for continuous data collection.</p>
<p>Buffer to store ADC readings for the potentiometer Initialize the potentiometer ADC and DMA setup </p>
<p>Enable peripheral clocks for GPIOB, ADC1, and DMA1</p>
<p>Configure the potentiometer GPIO pin as an analog input</p>
<p>Configure DMA1 Channel 1 for ADC requests</p>
<p>Reset DMA channel for fresh configuration</p>
<p>Set highest priority for the DMA channel</p>
<p>Set the DMA source address to ADC data register</p>
<p>Set the destination address to the buffer</p>
<p>Set the number of data elements to transfer</p>
<p>Configure memory data size as 16 bits</p>
<p>Configure peripheral data size as 16 bits</p>
<p>Enable circular mode for continuous data transfer</p>
<p>Enable memory increment mode to move through buffer</p>
<p>Configure DMA to read from the peripheral (ADC)</p>
<p>Enable the DMA channel</p>
<p>ADC setup: disable ADC to configure DMA settings</p>
<p>Turn off the ADC</p>
<p>Enable DMA mode in ADC</p>
<p>Disable end-of-conversion interrupt</p>
<p>Enable scan mode for multi-channel if needed</p>
<p>Disable internal temperature sensor channel</p>
<p>Enable continuous conversion mode</p>
<p>Set right alignment for ADC results</p>
<p>Set up the ADC channel sequence and sample time</p>
<p>Define the ADC channel for the potentiometer</p>
<p>Set ADC sequence to use only the specified channel</p>
<p>Set sample time for the channel</p>
<p>Power on the ADC and calibrate it</p>
<p>Turn on the ADC</p>
<p>Reset ADC calibration</p>
<p>Start ADC calibration</p>
<p>Wait for calibration to complete</p>
<p>Enable software trigger for conversion start</p>
<p>Start the ADC conversions</p>

<p class="definition">Definition at line <a class="el" href="setpoint_8c_source.html#l00008">8</a> of file <a class="el" href="setpoint_8c_source.html">setpoint.c</a>.</p>

<p class="reference">References <a class="el" href="setpoint_8h_source.html#l00015">N_DATA</a>, <a class="el" href="setpoint_8h_source.html#l00027">POT_ADC_CHANNEL</a>, <a class="el" href="setpoint_8h_source.html#l00030">POT_DMA_CHANNEL</a>, <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>, <a class="el" href="setpoint_8h_source.html#l00036">POT_PIN</a>, <a class="el" href="setpoint_8h_source.html#l00033">POT_PORT</a>, and <a class="el" href="setpoint_8h_source.html#l00021">SAMPLE_TIME_CYCLES</a>.</p>

<p class="reference">Referenced by <a class="el" href="setpoint_8c_source.html#l00008">pot_init()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_cgraph.png" border="0" usemap="#asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_cgraph" alt=""/></div>
<map name="asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_cgraph" id="asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_cgraph">
<area shape="rect" title="Initializes the ADC and DMA for potentiometer readings." alt="" coords="5,29,69,56"/>
<area shape="poly" title=" " alt="" coords="24,29,24,12,29,5,37,3,46,6,50,12,46,15,43,10,37,8,32,10,29,14,30,29"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="setpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_icgraph.png" border="0" usemap="#asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_icgraph" alt=""/></div>
<map name="asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_icgraph" id="asetpoint_8h_afc9477c3f1fe70660be0e366c146cb2a_icgraph">
<area shape="rect" title="Initializes the ADC and DMA for potentiometer readings." alt="" coords="5,29,69,56"/>
<area shape="poly" title=" " alt="" coords="46,15,43,10,37,8,32,10,29,14,30,29,24,29,24,12,29,5,37,3,46,6,50,12"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="setpoint_8h.html">setpoint.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
